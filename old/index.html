<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Workbench Designer с полями</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
          integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
<!-- Верхняя панель -->
<div id="toolbar">

    <!-- Работа с проектом -->
    <div class="group">
        <button title="Новый проект" id="newProject"><i class="far fa-file"></i></button>
        <button title="Сохранить проект" id="saveProject"><i class="fas fa-floppy-disk"></i></button>
        <button title="Открыть проект" id="loadProject"><i class="fas fa-folder-open"></i></button>
        <button title="Удалить проект" id="deleteProject"><i class="fas fa-trash"></i></button>
    </div>

    <div class="separator"></div>

    <!-- Undo/Redo и масштаб -->
    <div class="group">
        <button title="Undo" id="undo" class="disabled"><i class="fas fa-undo"></i></button>
        <button title="Redo" id="redo"><i class="fas fa-redo"></i></button>
        <button title="Увеличить масштаб" id="zoomIn"><i class="fas fa-magnifying-glass-plus"></i></button>
        <button title="Уменьшить масштаб" id="zoomOut"><i class="fas fa-magnifying-glass-minus"></i></button>
        <button title="Сброс масштаба" id="zoomReset"><i class="fas fa-magnifying-glass"></i></button>
    </div>

    <div class="separator"></div>

    <!-- Добавление -->
    <div class="group">
        <button title="Добавить таблицу" id="addBlock"><i class="fas fa-plus"></i></button>
        <button title="Добавить связь" id="addConnection"><i class="fas fa-link"></i></button>
    </div>

</div>

<!-- Центральная часть -->
<div id="main">
        <div class="workspace" id="workspace" style="">
            <svg id="connections" style="overflow: visible;">
                <defs>
                    <!-- одиночная палочка (1) -->
                    <marker id="one" markerWidth="6" markerHeight="20" refX="1" refY="10" orient="auto"
                            markerUnits="strokeWidth">
                        <path d="M1,0 L1,20" stroke="black" stroke-width="1"/>
                    </marker>

                    <!-- воронья лапка (N) -->
                    <marker id="many" class="marker-relation" markerWidth="14" markerHeight="14" refX="13" refY="7"
                            orient="auto" markerUnits="strokeWidth">
                        <path d="M13,0 L1,7 L13,14" stroke="gray" stroke-width="1" fill="none"/>
                    </marker>

                    <marker id="many-start" class="marker-relation" markerWidth="14" markerHeight="14" refX="0" refY="7"
                            orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L13,7 L0,13" stroke="gray" stroke-width="1" fill="none"/>
                    </marker>
                </defs>
            </svg>
        </div>

    <div id="splitter"></div>

    <div id="inspector">
        <h3>Инспектор</h3>
        <p>Выберите объект…</p>
        <p>X1: <span id="x1"></span></p>
        <p>Y1: <span id="y1"></span></p>
        <p>X2: <span id="x2"></span></p>
        <p>Y2: <span id="y2"></span></p>
        <p>X3: <span id="x3"></span></p>
        <p>Y3: <span id="y3"></span></p>
    </div>

</div>

<!-- Нижняя строка -->
<!--<div id="statusbar">-->
<!--    <span id="projectName">Проект: безымянный</span>-->
<!--    <span id="hint">Подсказка: ничего не выбрано</span>-->
<!--</div>-->

<script>
   // const hint = document.getElementById("hint");
   // document.getElementById("workspace").addEventListener("mousemove", e => {
   //     hint.textContent = `Координаты: ${e.offsetX}, ${e.offsetY}`;
   // });

    const splitter = document.getElementById('splitter');
    const work = document.getElementById('workspace');
    const inspector = document.getElementById('inspector');

    splitter.addEventListener('mousedown', e => {
        e.preventDefault();
        const startX = e.clientX;
        const startWorkspaceWidth = work.offsetWidth;
        const startInspectorWidth = inspector.offsetWidth;

        function onMouseMove(ev) {
            const dx = ev.clientX - startX;
            const newWorkspaceWidth = startWorkspaceWidth + dx;
            const newInspectorWidth = startInspectorWidth - dx;
            if (newWorkspaceWidth < 100 || newInspectorWidth < 100) return; // минимальные размеры
            work.style.flex = '0 0 ' + newWorkspaceWidth + 'px';
            inspector.style.width = newInspectorWidth + 'px';
        }

        function onMouseUp() {
            document.removeEventListener('mousemove', onMouseMove);
            document.removeEventListener('mouseup', onMouseUp);
        }

        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);
    });
</script>

<script src="storage.js"></script>
<script src="name_object.js"></script>
<script src="main.js"></script>

</body>
</html>
